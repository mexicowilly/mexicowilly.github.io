<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="itzcuintli.ico" type="image/x-icon"/>
<meta http-equiv="Content-Type" content="text/xhtml
charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>Chucho: chucho::security_policy Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px
">
  <td id="projectlogo"><img alt="Logo" src="itzcuintli_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em
">
   <div id="projectname">Chucho
   &#160
<span id="projectnumber">1.9</span>
   </div>
   <div id="projectbrief">A C++11 logging framework</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacechucho.html">chucho</a></li><li class="navelem"><a class="el" href="classchucho_1_1security__policy.html">security_policy</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classchucho_1_1security__policy-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">chucho::security_policy Class Reference<div class="ingroups"><a class="el" href="group__miscellaneous.html">Miscellaneous</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>The security policy is a means of controlling the external input to Chucho.  
 <a href="classchucho_1_1security__policy.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="security__policy_8hpp_source.html">chucho/security_policy.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a92fb4122afe11e41ca1774a86c3a8d06"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classchucho_1_1security__policy.html#a92fb4122afe11e41ca1774a86c3a8d06">get_default_text_max</a> () const </td></tr>
<tr class="memdesc:a92fb4122afe11e41ca1774a86c3a8d06"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the default maximum length of text.  <a href="#a92fb4122afe11e41ca1774a86c3a8d06">More...</a><br /></td></tr>
<tr class="separator:a92fb4122afe11e41ca1774a86c3a8d06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a27a45ac3ca45bccffa32bece15549e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classchucho_1_1optional.html">optional</a>&lt; std::pair&lt; std::intmax_t, std::intmax_t &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classchucho_1_1security__policy.html#a3a27a45ac3ca45bccffa32bece15549e">get_integer_range</a> (const std::string &amp;key) const </td></tr>
<tr class="memdesc:a3a27a45ac3ca45bccffa32bece15549e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the range of a given integer key.  <a href="#a3a27a45ac3ca45bccffa32bece15549e">More...</a><br /></td></tr>
<tr class="separator:a3a27a45ac3ca45bccffa32bece15549e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3737b9c75a5666b4545a005f4660f5ae"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classchucho_1_1security__policy.html#a3737b9c75a5666b4545a005f4660f5ae">get_text_max</a> (const std::string &amp;key) const </td></tr>
<tr class="memdesc:a3737b9c75a5666b4545a005f4660f5ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the maximum length of text set for a given key.  <a href="#a3737b9c75a5666b4545a005f4660f5ae">More...</a><br /></td></tr>
<tr class="separator:a3737b9c75a5666b4545a005f4660f5ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaea68658d460946a7707bcd8026fe3f1"><td class="memTemplParams" colspan="2">template&lt;typename val_type &gt; </td></tr>
<tr class="memitem:aaea68658d460946a7707bcd8026fe3f1"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classchucho_1_1security__policy.html#aaea68658d460946a7707bcd8026fe3f1">override_integer</a> (const std::string &amp;key, val_type low, val_type high)</td></tr>
<tr class="memdesc:aaea68658d460946a7707bcd8026fe3f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set an integer range.  <a href="#aaea68658d460946a7707bcd8026fe3f1">More...</a><br /></td></tr>
<tr class="separator:aaea68658d460946a7707bcd8026fe3f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e8dc9ff79a423893564e71052613a23"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classchucho_1_1security__policy.html#a1e8dc9ff79a423893564e71052613a23">override_text</a> (const std::string &amp;key, std::size_t max_len)</td></tr>
<tr class="memdesc:a1e8dc9ff79a423893564e71052613a23"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a text maximum length.  <a href="#a1e8dc9ff79a423893564e71052613a23">More...</a><br /></td></tr>
<tr class="separator:a1e8dc9ff79a423893564e71052613a23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57a24b2972914998a5461e2c0faeebce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classchucho_1_1security__policy.html#a57a24b2972914998a5461e2c0faeebce">set_default_text_max</a> (std::size_t dflt)</td></tr>
<tr class="memdesc:a57a24b2972914998a5461e2c0faeebce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the default maximum length of text.  <a href="#a57a24b2972914998a5461e2c0faeebce">More...</a><br /></td></tr>
<tr class="separator:a57a24b2972914998a5461e2c0faeebce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1999272b7436e4f5a9bc50438956630a"><td class="memTemplParams" colspan="2">template&lt;typename val_type &gt; </td></tr>
<tr class="memitem:a1999272b7436e4f5a9bc50438956630a"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classchucho_1_1security__policy.html#a1999272b7436e4f5a9bc50438956630a">set_integer</a> (const std::string &amp;key, val_type low, val_type high)</td></tr>
<tr class="memdesc:a1999272b7436e4f5a9bc50438956630a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set an integer range.  <a href="#a1999272b7436e4f5a9bc50438956630a">More...</a><br /></td></tr>
<tr class="separator:a1999272b7436e4f5a9bc50438956630a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b00d29fa4a9d0e10039d01dbe275bc5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classchucho_1_1security__policy.html#a9b00d29fa4a9d0e10039d01dbe275bc5">set_text</a> (const std::string &amp;key, std::size_t max_len)</td></tr>
<tr class="memdesc:a9b00d29fa4a9d0e10039d01dbe275bc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a text maximum length.  <a href="#a9b00d29fa4a9d0e10039d01dbe275bc5">More...</a><br /></td></tr>
<tr class="separator:a9b00d29fa4a9d0e10039d01dbe275bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2526ba8dbd356dc0be46f3262f13655"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classchucho_1_1security__policy.html#ad2526ba8dbd356dc0be46f3262f13655">validate</a> (const std::string &amp;key, const std::string &amp;val) const </td></tr>
<tr class="memdesc:ad2526ba8dbd356dc0be46f3262f13655"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate a text length value.  <a href="#ad2526ba8dbd356dc0be46f3262f13655">More...</a><br /></td></tr>
<tr class="separator:ad2526ba8dbd356dc0be46f3262f13655"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2daf9a6fae1310271a9dbf4e7940a9f2"><td class="memTemplParams" colspan="2">template&lt;typename val_type &gt; </td></tr>
<tr class="memitem:a2daf9a6fae1310271a9dbf4e7940a9f2"><td class="memTemplItemLeft" align="right" valign="top">val_type&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classchucho_1_1security__policy.html#a2daf9a6fae1310271a9dbf4e7940a9f2">validate</a> (const std::string &amp;key, const val_type &amp;val) const </td></tr>
<tr class="memdesc:a2daf9a6fae1310271a9dbf4e7940a9f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate an integer range value.  <a href="#a2daf9a6fae1310271a9dbf4e7940a9f2">More...</a><br /></td></tr>
<tr class="separator:a2daf9a6fae1310271a9dbf4e7940a9f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Constructor</div></td></tr>
<tr class="memitem:a39bb7476ad512f7467c8562be95bc680"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classchucho_1_1security__policy.html#a39bb7476ad512f7467c8562be95bc680">security_policy</a> ()</td></tr>
<tr class="memdesc:a39bb7476ad512f7467c8562be95bc680"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a security policy.  <a href="#a39bb7476ad512f7467c8562be95bc680">More...</a><br /></td></tr>
<tr class="separator:a39bb7476ad512f7467c8562be95bc680"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The security policy is a means of controlling the external input to Chucho. </p>
<p>External input consists of data that enter the system from the configuration source. Integers can be bounded by certain ranges and text can be bounded by its length. This helps to prevent attacks on the application that could come from crazy values in the configuration source.</p>
<p>There is a default security policy, which can easily be modified or eliminated. The method <a class="el" href="classchucho_1_1configuration.html#a42e9fbd8ebdd9aa7f2e5f4e8f3cfc7ff">configuration::get_security_policy</a> can be used for this purpose before configuration actually occurs.</p>
<p>For text bounds, there is a default maximum length of 2,048 bytes. If a text value does not have an explicit length limit, then the default is used. However, if an integer value does not have an explicit range limit, then the validation, and thus the configuration, fails. You may set the default to any value you wish.</p>
<p>Data members are identified by a textual key. For example, if you with to restrict a <a class="el" href="classchucho_1_1file__writer.html">file_writer</a> file name to 10 characters, you would use the following: </p><div class="fragment"><div class="line"><a class="code" href="classchucho_1_1configuration.html#a42e9fbd8ebdd9aa7f2e5f4e8f3cfc7ff">chucho::configuration::get_security_policy</a>().<a class="code" href="classchucho_1_1security__policy.html#a9b00d29fa4a9d0e10039d01dbe275bc5">set_text</a>(<span class="stringliteral">&quot;file_writer::file_name&quot;</span>, 10); </div>
</div><!-- fragment --><p> The following is the default security policy. </p><table class="doxtable">
<tr>
<th>Key</th><th>Value </th></tr>
<tr>
<td>async_writer::queue_capacity </td><td>[10, 32768] </td></tr>
<tr>
<td>async_writer::queue_capacity(text) </td><td>5 </td></tr>
<tr>
<td>async_writer::discard_threshold </td><td><em>default</em> </td></tr>
<tr>
<td>async_writer::flush_on_destruct </td><td>5 </td></tr>
<tr>
<td>email_writer::buffer_size </td><td>[1, 65536] </td></tr>
<tr>
<td>email_writer::buffer_size(text) </td><td>5 </td></tr>
<tr>
<td>email_writer::connection_type </td><td>8 </td></tr>
<tr>
<td>email_writer::from </td><td>320 </td></tr>
<tr>
<td>email_writer::host </td><td>253 </td></tr>
<tr>
<td>email_writer::port </td><td>[1, 65535] </td></tr>
<tr>
<td>email_writer::port(text) </td><td>5 </td></tr>
<tr>
<td>email_writer::subject </td><td>989 </td></tr>
<tr>
<td>email_writer::to(address) </td><td>[1, 320] </td></tr>
<tr>
<td>email_writer::to(count) </td><td>[1, 100] </td></tr>
<tr>
<td>email_writer::to(text) </td><td>32100 </td></tr>
<tr>
<td>email_writer::user </td><td>320 </td></tr>
<tr>
<td>email_writer::verbose </td><td>5 </td></tr>
<tr>
<td>file_compressor::min_index </td><td>[1, 1000] </td></tr>
<tr>
<td>file_compressor::min_index(text) </td><td>4 </td></tr>
<tr>
<td>file_writer::file_name </td><td><em>default</em> </td></tr>
<tr>
<td>file_writer::flush </td><td>5 </td></tr>
<tr>
<td>file_writer::on_start </td><td>8 </td></tr>
<tr>
<td>interval_file_roll_trigger::count </td><td>[1, 5000] </td></tr>
<tr>
<td>interval_file_roll_trigger::period(text) </td><td>12 </td></tr>
<tr>
<td>level_filter::level </td><td><em>default</em> </td></tr>
<tr>
<td>level_filter::on_match </td><td>7 </td></tr>
<tr>
<td>level_filter::on_mismatch </td><td>7 </td></tr>
<tr>
<td>level_threshold_email_trigger::level </td><td><em>default</em> </td></tr>
<tr>
<td>level_threshold_filter::level </td><td><em>default</em> </td></tr>
<tr>
<td>logger::level </td><td><em>default</em> </td></tr>
<tr>
<td>logger::name </td><td><em>default</em> </td></tr>
<tr>
<td>logger::writes_to_ancestors </td><td>5 </td></tr>
<tr>
<td>mysql_writer::host </td><td>253 </td></tr>
<tr>
<td>mysql_writer::user </td><td>16 </td></tr>
<tr>
<td>mysql_writer::password </td><td><em>default</em> </td></tr>
<tr>
<td>mysql_writer::database </td><td>64 </td></tr>
<tr>
<td>mysql_writer::port </td><td>[1, 65535] </td></tr>
<tr>
<td>mysql_writer::port(text) </td><td>5 </td></tr>
<tr>
<td>mysql_writer::queue_capacity </td><td>[10, 32768] </td></tr>
<tr>
<td>mysql_writer::queue_capacity(text) </td><td>5 </td></tr>
<tr>
<td>mysql_writer::discard_threshold </td><td><em>default</em> </td></tr>
<tr>
<td>mysql_writer::flush_on_destruct </td><td>5 </td></tr>
<tr>
<td>named_pipe_writer::flush </td><td>5 </td></tr>
<tr>
<td>named_pipe_writer::name </td><td><em>default</em> </td></tr>
<tr>
<td>numbered_file_roller::min_index </td><td>[-1000, 1000] </td></tr>
<tr>
<td>numbered_file_roller::min_index(text) </td><td>5 </td></tr>
<tr>
<td>numbered_file_roller::max_index </td><td>[-1000, 1000] </td></tr>
<tr>
<td>numbered_file_roller::max_index(text) </td><td>5 </td></tr>
<tr>
<td>oracle_writer::user </td><td>30 </td></tr>
<tr>
<td>oracle_writer::password </td><td>30 </td></tr>
<tr>
<td>oracle_writer::database </td><td>512 </td></tr>
<tr>
<td>pattern_formatter::pattern </td><td><em>default</em> </td></tr>
<tr>
<td>pipe_writer::flush </td><td>5 </td></tr>
<tr>
<td>postgres_writer::uri </td><td>8000 </td></tr>
<tr>
<td>remote_writer::port </td><td>[1, 65535] </td></tr>
<tr>
<td>remote_writer::port(text) </td><td>5 </td></tr>
<tr>
<td>ruby_evaluator_filter::expression </td><td><em>default</em> </td></tr>
<tr>
<td>size_file_roll_trigger::max_size </td><td>[1, 1G] </td></tr>
<tr>
<td>size_file_roll_trigger::max_size(text) </td><td>50 </td></tr>
<tr>
<td>sliding_numbered_file_roller::min_index </td><td>[-1000, 1000] </td></tr>
<tr>
<td>sliding_numbered_file_roller::min_index(text) </td><td>5 </td></tr>
<tr>
<td>sliding_numbered_file_roller::max_count </td><td>[1, 1000] </td></tr>
<tr>
<td>sliding_numbered_file_roller::max_count(text) </td><td>4 </td></tr>
<tr>
<td>sqlite_writer::file_name </td><td><em>default</em> </td></tr>
<tr>
<td>syslog_writer::facility </td><td>8 </td></tr>
<tr>
<td>syslog_writer::host_name </td><td>253 </td></tr>
<tr>
<td>syslog_writer::port </td><td>[1, 65535] </td></tr>
<tr>
<td>syslog_writer::port(text) </td><td>5 </td></tr>
<tr>
<td>time_file_roller::file_name_pattern </td><td><em>default</em> </td></tr>
<tr>
<td>time_file_roller::max_history </td><td>[1, 1000] </td></tr>
<tr>
<td>time_file_roller::max_history(text) </td><td>4 </td></tr>
<tr>
<td>zeromq_writer::endpoint </td><td><em>default</em> </td></tr>
<tr>
<td>zeromq_writer::prefix </td><td><em>default</em> </td></tr>
</table>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a39bb7476ad512f7467c8562be95bc680"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">chucho::security_policy::security_policy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a security policy. </p>
<p>Using this constructor will accomplish nothing. If you need to query or modify the security policy, you may retrieve the one in use by calling <a class="el" href="classchucho_1_1configuration.html#a42e9fbd8ebdd9aa7f2e5f4e8f3cfc7ff">configuration::get_security_policy</a>. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a92fb4122afe11e41ca1774a86c3a8d06"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t chucho::security_policy::get_default_text_max </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the default maximum length of text. </p>
<dl class="section return"><dt>Returns</dt><dd>the default maximum length of text </dd></dl>

</div>
</div>
<a class="anchor" id="a3a27a45ac3ca45bccffa32bece15549e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classchucho_1_1optional.html">optional</a>&lt;std::pair&lt;std::intmax_t, std::intmax_t&gt; &gt; chucho::security_policy::get_integer_range </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the range of a given integer key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>they key </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the range that has been set, or an empty <a class="el" href="classchucho_1_1optional.html">optional</a> if no range has been set </dd></dl>

</div>
</div>
<a class="anchor" id="a3737b9c75a5666b4545a005f4660f5ae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t chucho::security_policy::get_text_max </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the maximum length of text set for a given key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>the key </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the set length or the result of <a class="el" href="classchucho_1_1security__policy.html#a92fb4122afe11e41ca1774a86c3a8d06">get_default_text_max()</a> if no value has been set for the key </dd></dl>

</div>
</div>
<a class="anchor" id="aaea68658d460946a7707bcd8026fe3f1"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename val_type &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void chucho::security_policy::override_integer </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">val_type&#160;</td>
          <td class="paramname"><em>low</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">val_type&#160;</td>
          <td class="paramname"><em>high</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set an integer range. </p>
<p>This method clobbers any existing integer value for the key. The method <a class="el" href="classchucho_1_1security__policy.html#a1999272b7436e4f5a9bc50438956630a">set_integer</a> will not set the range if there is already an existing range for the key.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>the key </td></tr>
    <tr><td class="paramname">low</td><td>the minimum value of the range </td></tr>
    <tr><td class="paramname">high</td><td>the maximum value of the range </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a1e8dc9ff79a423893564e71052613a23"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void chucho::security_policy::override_text </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>max_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set a text maximum length. </p>
<p>This method clobbers any existing text value for the key. The method <a class="el" href="classchucho_1_1security__policy.html#a9b00d29fa4a9d0e10039d01dbe275bc5">set_text</a> will not set the maximum length if there is already an existing maximum for the key.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>the key </td></tr>
    <tr><td class="paramname">max_len</td><td>the maximum value of the length </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a57a24b2972914998a5461e2c0faeebce"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void chucho::security_policy::set_default_text_max </td>
          <td>(</td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>dflt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the default maximum length of text. </p>
<p>If no specific maximum text length is set for the key, then the default is used.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dflt</td><td>the default maximum length </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a1999272b7436e4f5a9bc50438956630a"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename val_type &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void chucho::security_policy::set_integer </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">val_type&#160;</td>
          <td class="paramname"><em>low</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">val_type&#160;</td>
          <td class="paramname"><em>high</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set an integer range. </p>
<p>This method will not replace an existing range for the key. If you wish to unconditionally set the range, then please use <a class="el" href="classchucho_1_1security__policy.html#aaea68658d460946a7707bcd8026fe3f1">override_integer</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>the key </td></tr>
    <tr><td class="paramname">low</td><td>the minimum value of the range </td></tr>
    <tr><td class="paramname">high</td><td>the maximum value of the range </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a9b00d29fa4a9d0e10039d01dbe275bc5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void chucho::security_policy::set_text </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>max_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a text maximum length. </p>
<p>This method will not replace an existing maximum length for the key. If you wish to unconditionally set the maximum length, then please use <a class="el" href="classchucho_1_1security__policy.html#a1e8dc9ff79a423893564e71052613a23">override_text</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>the key </td></tr>
    <tr><td class="paramname">max_len</td><td>the maximum value of the length </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ad2526ba8dbd356dc0be46f3262f13655"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string chucho::security_policy::validate </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validate a text length value. </p>
<p>This method is called from the <a class="el" href="classchucho_1_1memento.html">memento</a> of the <a class="el" href="classchucho_1_1configurable.html">configurable</a> that should validate the value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>the key </td></tr>
    <tr><td class="paramname">val</td><td>the text to validate </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exception</td><td>if the value does not conform to the security policy </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2daf9a6fae1310271a9dbf4e7940a9f2"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename val_type &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">val_type chucho::security_policy::validate </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const val_type &amp;&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validate an integer range value. </p>
<p>This method is called from the <a class="el" href="classchucho_1_1memento.html">memento</a> of the <a class="el" href="classchucho_1_1configurable.html">configurable</a> that should validate the value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>the key </td></tr>
    <tr><td class="paramname">val</td><td>the integer to validate </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exception</td><td>if the value does not conform to the security policy </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="security__policy_8hpp_source.html">security_policy.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun May 15 2016 19:29:18 for Chucho by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
